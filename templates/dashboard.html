<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
</head>
<body>
    <h2>Hello, {{ current_user.username }}! Welcome to your dashboard.</h2>

    <h3>Your Projects</h3>
    {% if projects %}
        <ul>
        {% for project in projects %}
            <li>{{ project.name }} - Status: {{ project.status }}</li>
            <form method="POST" action="{{ url_for('clock_in', project_id=project.id) }}">
                <button type="submit">Clock In</button>
            </form>

            <form method="POST" action="{{ url_for('complete_project', project_id=project.id) }}">
                <button type="submit">Mark as Complete</button>
            </form>
            
            {% for timesheet in timesheets %}
                {% if timesheet.project_id == project.id and not timesheet.clock_out %}
                    <form method="POST" action="{{ url_for('clock_out', timesheet_id=timesheet.id) }}">
                        <label for="note">Note:</label>
                        <input type="text" name="note" maxlength="500">
                        <button type="submit">Clock Out</button>
                    </form>
                {% endif %}
            {% endfor %}
        {% endfor %}
        </ul>
    {% else %}
        <p>No projects found.</p>
    {% endif %}

    <h3>Your Timesheets</h3>
    {% if timesheets %}
        <ul>
        {% for timesheet in timesheets %}
            <li>Project ID: {{ timesheet.project_id }} | Clock In: {{ timesheet.clock_in }} | Clock Out: {{ timesheet.clock_out }} | Note: {{ timesheet.note }}</li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No timesheets found.</p>
    {% endif %}


    <a href="{{ url_for('create_project') }}">Create a New Project</a><br>
    <a href="{{ url_for('archives') }}">View Archived Projects</a>

</body>
</html>

